parameters:
  - name: solution
    type: string
  - name: buildPlatform
    type: string
  - name: buildConfiguration
    type: string
    # default: 'Debug'
  - name: useNetVersion
    type: string


steps:
  # prepare
  # - task: UseDotNet@2
  #   inputs:
  #     version: ${{ parameters.useNetVersion }}
  #     packageType: 'sdk'
  #     #includePreviewVersions: true
    # info
  - pwsh: $PSVersionTable
    name: PSVersionTable
  - script: dotnet --info
    name: dotnet_info
  - script: dotnet msbuild -version
    name: MSBuild_info
  # build
  - task: NuGetToolInstaller@1
  - task: NuGetCommand@2
    inputs:
      restoreSolution: ${{ parameters.solution }}
  - task: VSBuild@1
    inputs:
      solution: ${{ parameters.solution }}
      platform: ${{ parameters.buildPlatform }}
      configuration: ${{ parameters.buildConfiguration }}
    continueOnError: true
  - script: dotnet msbuild
    name: MSBuild
  - task: DotNetCoreCLI@2
    name: MSBuild_Build
    inputs:
      command: 'build'
      arguments: '-restore -t:Rebuild -p:Configuration=${{ parameters.buildConfiguration }}'
